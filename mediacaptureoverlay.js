javascript:(function(){let v=null;for(let el of document.querySelectorAll("video")){if(el.currentTime>0&&!el.paused&&!el.ended&&el.readyState>2&&el.videoWidth>0){v=el;break}}if(!v||!v.videoWidth){alert("No active HTML5 video found on this page.");return}const ts=()=>{const d=new Date(),p=n=>String(n).padStart(2,"0");return d.getFullYear()+p(d.getMonth()+1)+p(d.getDate())+p(d.getHours())+p(d.getMinutes())+p(d.getSeconds())};const canvas=document.createElement("canvas");canvas.width=v.videoWidth;canvas.height=v.videoHeight;const ctx=canvas.getContext("2d");const mime="video/mp4";let interval=null,recorder=null,chunks=[],recording=false;function start(){try{const stream=canvas.captureStream(30);recorder=new MediaRecorder(stream,{mimeType:mime});chunks=[];recorder.ondataavailable=e=>chunks.push(e.data);recorder.onstop=()=>{const blob=new Blob(chunks,{type:mime});const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;a.download="video_"+ts()+".mp4";a.click();URL.revokeObjectURL(url)};interval=setInterval(()=>{ctx.drawImage(v,0,0,canvas.width,canvas.height)},33);recorder.start();btnRec.textContent="Stop";recording=true}catch(e){alert("Failed to start recording. Your browser may not support MediaRecorder.");console.error(e)}}function stop(){try{clearInterval(interval);recorder.stop();btnRec.textContent="Record";recording=false}catch(e){alert("Failed to stop recording.");console.error(e)}}function snap(){try{ctx.drawImage(v,0,0,canvas.width,canvas.height);const url=canvas.toDataURL("image/png");const a=document.createElement("a");a.href=url;a.download="image_"+ts()+".png";a.click()}catch(e){alert("Failed to capture image.");console.error(e)}}const pill=document.createElement("div");pill.style.cssText="position:fixed;top:20px;right:20px;display:flex;gap:8px;background:#111;color:#fff;padding:8px 10px;border-radius:999px;font-family:system-ui,sans-serif;font-size:14px;z-index:999999;box-shadow:0 4px 12px rgba(0,0,0,.4);user-select:none;";const btnSnap=document.createElement("div");btnSnap.textContent="Capture";btnSnap.style.cssText="padding:6px 12px;border-radius:999px;background:#222;cursor:pointer;";const btnRec=document.createElement("div");btnRec.textContent="Record";btnRec.style.cssText="padding:6px 12px;border-radius:999px;background:#222;cursor:pointer;";btnSnap.onclick=snap;btnRec.onclick=()=>{recording?stop():start()};pill.appendChild(btnSnap);pill.appendChild(btnRec);document.body.appendChild(pill);})();
